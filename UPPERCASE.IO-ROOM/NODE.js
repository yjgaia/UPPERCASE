FOR_BOX(function(o){"use strict";o.BROADCAST=METHOD({run:function(a){var t=o.boxName+"/"+a.roomName,E=a.methodName,_=a.data;LAUNCH_ROOM_SERVER.broadcast({roomName:t,methodName:E,data:_}),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__LAUNCH_ROOM_SERVER__MESSAGE",data:{roomName:t,methodName:E,data:_}}),void 0!==SERVER_CLUSTERING.broadcast&&SERVER_CLUSTERING.broadcast({methodName:"__LAUNCH_ROOM_SERVER__MESSAGE",data:{roomName:t,methodName:E,data:_}})}})}),FOR_BOX(function(o){"use strict";o.ROOM=METHOD({run:function(a,t){LAUNCH_ROOM_SERVER.addInitRoomFunc(o.boxName+"/"+a,t)}})}),global.LAUNCH_ROOM_SERVER=LAUNCH_ROOM_SERVER=METHOD(function(o){"use strict";var a,t,E={},_={};return o.addInitRoomFunc=a=function(o,a){void 0===E[o]&&(E[o]=[]),E[o].push(a)},o.broadcast=t=function(o){var a=o.roomName,t=_[a];void 0!==t&&EACH(t,function(t){t({methodName:a+"/"+o.methodName,data:o.data})})},{run:function(o){void 0!==CPU_CLUSTERING.on&&CPU_CLUSTERING.on("__LAUNCH_ROOM_SERVER__MESSAGE",t),void 0!==SERVER_CLUSTERING.on&&SERVER_CLUSTERING.on("__LAUNCH_ROOM_SERVER__MESSAGE",function(o){t(o),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__LAUNCH_ROOM_SERVER__MESSAGE",data:o})}),MULTI_PROTOCOL_SOCKET_SERVER(o,function(o,a,t,R){var n={};a("__ENTER_ROOM",function(d){var e=E[d],N=_[d];void 0===n[d]?(n[d]=1,void 0!==e&&EACH(e,function(E){E(o,function(o,t){a(d+"/"+o,t)},function(o,a){t(d+"/"+o,a)},function(o,a){R({methodName:d+"/"+o.methodName,data:o.data},a)})}),void 0===N&&(N=_[d]=[]),N.push(R)):n[d]+=1}),a("__EXIT_ROOM",function(o){void 0!==n[o]&&(n[o]-=1,0===n[o]&&(REMOVE({data:_[o],value:R}),0===_[o].length&&delete _[o],delete n[o]))}),a("__DISCONNECTED",function(){EACH(n,function(o,a){REMOVE({data:_[a],value:R}),0===_[a].length&&delete _[a]}),n=void 0})})}}});